{% extends "vps/view-hdr.html" %}
{% block title %}{{ service.name }} - Servers{% endblock %}
{% set subtitle='IP Admin' %}

{% block component %}

<h3>IP Allocation / Planning [eth0: {{ service.mac }}]</h3>

<table class="table table-striped">
<tr>
<th>IP Address</th>
<th>IP Version</th>
<th>Network</th>
<th>Gateway</th>
<th>Broadcast</th>
<th>Netmask</th>
<th>Reverse DNS</th>
<th>
	<span class="pull-right">Options</span>
</th>
</tr>
{% for ipaddr in service.ips %}
<tr>
	<td>{{ ipaddr.ip }}</td>
	<td>IPv{{ ipaddr.ipnet.ipnet().version }}</td>
	<td>{{ ipaddr.ipnet.ipnet().network_address }} / {{ ipaddr.ipnet.ipnet().prefixlen }}</td>
	<td>{{ ipaddr.ipnet.gateway() }}</td>
	{% if ipaddr.ipnet.ipnet().version == 4 %}
		<td>{{ ipaddr.ipnet.broadcast() }}</td>
		<td>{{ ipaddr.ipnet.ipnet().netmask }}</td>
	{% else %}
		<td>&mdash;</td>
		<td>&mdash;</td>
	{% endif %}
	<td>{{ ipaddr.lookup_rdns() }}</td>
	<td>
		<span class="pull-right btn-group">
			<a href="{{ url_for('.adm_del_ip', vps=service.id, ip=ipaddr.id) }}" class="btn btn-danger"><i class="icon-trash"></i> Delete</a>
		</span>
	</td>
</tr>
{% endfor %}
</table>

<h4>Add Additional IP</h4>

<p>You may add <strong>{{ service.ipv4_quota() }}</strong> additional IPv4 addresses to this service.</p>

<p>You may add <strong>{{ service.ipv6_quota() }}</strong> additional IPv6 addresses to this service.</p>

<form method="POST" action="{{ url_for('.adm_add_ip', vps=service.id) }}">
<select name="ipbox">
{% for iprange in service.node.ipranges %}
{% for host in iprange.available_ips() %}
{% if not iprange.is_ipv6() and service.ipv4_quota() > 0 %}
	<option value="{{ iprange.id }}!{{ host }}">{{ host }}</option>
{% endif %}
{% if iprange.is_ipv6() and service.ipv6_quota() > 0 %}
	<option value="{{ iprange.id }}!{{ host }}">{{ host }}</option>
{% endif %}
{% endfor %}
{% endfor %}
</select><br>
<button type="submit" class="btn btn-primary">Add</button>
</form>

{% endblock %}
