{% extends "base-scaffolding.html" %}
{% if service %}
	{% set svclist = service.user.services %}
{% else %}
	{% if user %}
		{% set svclist = user.services %}
	{% endif %}
{% endif %}

{% block serversidebar %}
	<ul class="nav nav-list">
		<li{{ ' class="active"'|safe if subtitle == 'New Server' else '' }}><a href="{{ url_for('.signup') }}">New Server</a></li>
		{% if user.is_admin %}
		<li><a href="{{ url_for('.list_all') }}"><i class="icon-lock"></i> View All Servers</a></li>
		{% endif %}

		{% for vps in svclist %}
		{% if vps.is_entitled %}
			{% if service and vps.name == service.name %}
				<li class="active">
					<a href="{{ url_for('.view', vps=vps.id) }}">{{ vps.name }}</a>
				</li>
				<li>
					<ul class="nav nav-list">
						<li class="nav-header">Power Control</li>
						<li><a class="jsonify" href="{{ url_for('.create', vps=service.id) }}">Start</a></li>
						<li><a class="jsonify" href="{{ url_for('.shutdown', vps=service.id) }}">Shutdown</a></li>
						<li><a class="jsonify" href="{{ url_for('.destroy', vps=service.id) }}">Forceful Shutdown</a></li>
						<li><a class="jsonify" href="{{ url_for('.powercycle', vps=service.id) }}">Powercycle</a></li>

						<li class="nav-header">Management</li>
						<li{{ ' class="active"'|safe if subtitle == 'Dashboard' else '' }}><a href="{{ url_for('.view', vps=service.id) }}">Dashboard</a></li>
						<li{{ ' class="active"'|safe if subtitle == 'Graphs' else '' }}><a href="{{ url_for('.graphs', vps=service.id) }}">Graphs</a></li>
						<li{{ ' class="active"'|safe if subtitle == 'IP Admin' else '' }}><a href="{{ url_for('.ip_admin', vps=service.id) }}">IP Admin</a></li>
						<li{{ ' class="active"'|safe if subtitle == 'Deploy' else '' }}><a href="{{ url_for('.deploy', vps=service.id) }}">Deploy / Reinstall OS</a></li>
						<li{{ ' class="active"'|safe if subtitle == 'Clone' else '' }}><a href="{{ url_for('.clone', vps=service.id) }}">Clone</a></li>
						<li{{ ' class="active"'|safe if subtitle == 'Jobs' else '' }}><a href="{{ url_for('.jobs', vps=service.id) }}">Jobs</a></li>
						<li{{ ' class="active"'|safe if subtitle == 'Profiler' else '' }}><a href="{{ url_for('.profiler', vps=service.id) }}">Profiler</a></li>
						{% if service.profile.name != 'HVM' %}
							<li{{ ' class="active"'|safe if subtitle == 'Console' else '' }}><a href="{{ url_for('.console', vps=service.id) }}">Serial Console</a></li>
						{% else %}
							<li{{ ' class="active"'|safe if subtitle == 'HVM' else '' }}><a href="{{ url_for('.hvmvnc', vps=service.id) }}">HVM Configuration</a></li>
						{% endif %}
						<li{{ ' class="active"'|safe if subtitle == 'Monitoring' else '' }}><a href="{{ url_for('.monitor_list', vps=service.id) }}">Monitoring</a></li>
					</ul>
				<li>
			{% else %}
				<li><a href="{{ url_for('.view', vps=vps.id) }}">{{ vps.name }}</a></li>
			{% endif %}
		{% endif %}
		{% endfor %}
	</ul>
{% endblock %}

{% block content %}

{% if service %}
<div id="admDelete" class="modal hide fade" tabindex="-1" role="dialog">
	<div class="modal-header">
		<a href="#"  type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
		<h3>Are you sure?</h3>
	</div>
	<div class="modal-body">
		<p>If you continue, your VPS will be permanently deleted.  We will not have any way to recover the data!</p>
	</div>
	<div class="modal-footer">
		<a href="#"  class="btn" data-dismiss="modal" aria-hidden="true">Close</a>
		<a href="{{ url_for('.adm_delete', vps=service.id) }}" class="btn btn-danger">Delete</a>
	</div>
</div>
{% endif %}

<div class="row-fluid">

<div class="span12">
	{% block subcontent %}{% endblock %}
</div>

</div>

{% endblock %}
